var ddexitpop=function($){var defaults={delayregister:0,delayshow:200,hideaftershow:!0,displayfreq:"always",persistcookie:"ddexitpop_shown",fxclass:"rubberBand",mobileshowafter:3e3,onddexitpop:function(){}},animatedcssclasses=["fadeIn"],isTouch,crossdeviceclickevt="ontouchstart"in window||navigator.msMaxTouchPoints>0?"touchstart":"click";function getCookie(Name){var re=new RegExp(Name+"=[^;]+","i");return document.cookie.match(re)?document.cookie.match(re)[0].split("=")[1]:null}function setCookie(name,value,duration){var expirestr="",expiredate=new Date;if(void 0!==duration){var offsetmin=parseInt(duration)*(/hr/i.test(duration)?60:/day/i.test(duration)?1440:1);expiredate.setMinutes(expiredate.getMinutes()+offsetmin),expirestr="; expires="+expiredate.toUTCString()}document.cookie=name+"="+value+"; path=/"+expirestr}function makeajaxfriendly(url){if(/^http/i.test(url)){var dummyurl=document.createElement("a");return dummyurl.href=url,dummyurl.href.replace(RegExp(dummyurl.hostname,"i"),location.hostname)}return url}var ddexitpop={wrappermarkup:'<div id="ddexitpopwrapper"><div class="veil"></div></div>',$wrapperref:null,$contentref:null,displaypopup:!0,delayshowtimer:null,settings:null,ajaxrequest:function(filepath){var ajaxfriendlyurl=makeajaxfriendly(filepath);$.ajax({url:ajaxfriendlyurl,dataType:"html",error:function(ajaxrequest){alert("Error fetching content.<br />Server Response: "+ajaxrequest.responseText)},success:function(content){ddexitpop.$contentref=$(content).appendTo(document.body),ddexitpop.setup(ddexitpop.$contentref)}})},detectexit:function(e){e.clientY<60&&(this.delayshowtimer=setTimeout((function(){ddexitpop.showpopup(),ddexitpop.settings.onddexitpop(ddexitpop.$contentref)}),this.settings.delayshow))},detectenter:function(e){e.clientY<60&&clearTimeout(this.delayshowtimer)},showpopup:function(){null!=this.$contentref&&1==this.displaypopup&&(!0===this.settings.randomizefxclass&&(this.settings.fxclass=animatedcssclasses[Math.floor(Math.random()*animatedcssclasses.length)]),this.$wrapperref.addClass("open"),this.$contentref.addClass(this.settings.fxclass),this.displaypopup=!1,this.settings.hideaftershow&&$(document).off("mouseleave.registerexit"))},hidepopup:function(){this.$wrapperref.removeClass("open"),this.$contentref.removeClass(this.settings.fxclass),this.displaypopup=!0},setup:function($content){this.$contentref.addClass("animated"),this.$wrapperref=$(this.wrappermarkup).appendTo(document.body),this.$wrapperref.append(this.$contentref),this.$wrapperref.find(".veil").on(crossdeviceclickevt,(function(){ddexitpop.hidepopup()})),"always"!=this.settings.displayfreq&&("session"==this.settings.displayfreq?setCookie(this.settings.persistcookie,"yes"):/\d+(hr|day)/i.test(this.settings.displayfreq)&&(setCookie(this.settings.persistcookie,"yes",this.settings.displayfreq),setCookie(this.settings.persistcookie+"_duration",this.settings.displayfreq,this.settings.displayfreq)))},init:function(options){var s=$.extend({},defaults,options),persistduration=getCookie(s.persistcookie+"_duration");!persistduration||"session"!=s.displayfreq&&s.displayfreq==persistduration||(setCookie(s.persistcookie,"yes",-1),setCookie(s.persistcookie+"_duration","",-1)),"always"!=s.displayfreq&&getCookie(s.persistcookie)||("random"==s.fxclass&&(s.randomizefxclass=!0),this.settings=s,"ajax"==s.contentsource[0]?this.ajaxrequest(s.contentsource[1]):"id"==s.contentsource[0]?(this.$contentref=$("#"+s.contentsource[1]).appendTo(document.body),this.setup(this.$contentref)):"inline"==s.contentsource[0]&&(this.$contentref=$(s.contentsource[1]).appendTo(document.body),this.setup(this.$contentref)),setTimeout((function(){$(document).on("mouseleave.registerexit",(function(e){ddexitpop.detectexit(e)})),$(document).on("mouseenter.registerenter",(function(e){ddexitpop.detectenter(e)}))}),s.delayregister),s.mobileshowafter>0&&$(document).one("touchstart",(function(){setTimeout((function(){ddexitpop.showpopup()}),s.mobileshowafter)})))}};return ddexitpop}(jQuery);jQuery(document).ready((function(){ddexitpop.init({contentsource:["id","ddexitpop"],fxclass:"random",displayfreq:"always",onddexitpop:function($popup){console.log("Exit Pop Animation Class Name: "+ddexitpop.settings.fxclass)}})}));